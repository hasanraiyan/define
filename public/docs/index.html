<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exact Word Definer API Documentation v1.12.0 (Single File Edition)</title>
    <!-- Tailwind CSS CDN with Typography Plugin -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <!-- Prism.js for Syntax Highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <style>
        /* Improve focus visibility for accessibility */
        :focus-visible {
            outline: 2px solid #3b82f6; /* blue-500 */
            outline-offset: 2px;
            border-radius: 2px;
        }

        /* Custom styles for Prism.js compatibility and layout */
        pre[class*="language-"] {
            @apply rounded-md p-4 text-sm font-mono overflow-auto relative mt-2 mb-4 shadow; /* Add margin, relative for copy */
        }
        :not(pre) > code[class*="language-"], pre[class*="language-"] {
            @apply bg-gray-800; /* Match Prism theme background */
        }
        code[class*="language-"], pre[class*="language-"] {
             @apply text-gray-100;
             word-break: break-word;
             white-space: pre-wrap;
        }
        /* Inline code styling (using typography plugin is preferred for prose) */
        /* Use prose-code: classes from typography plugin where possible */
        :not(pre) > code:not([class*="language-"]) { /* Target only non-highlighted inline code */
            @apply font-mono text-sm bg-gray-100 px-1.5 py-0.5 rounded border border-gray-300 text-purple-700;
        }


        /* Styles for interactive JSON output */
        .json-output-container {
            @apply border border-gray-300 rounded-md mt-2 min-h-[100px] max-h-[450px] overflow-auto relative bg-gray-800; /* Match pre bg */
        }
         .json-output-container pre {
            @apply m-0 !important; /* Override potential conflicts */
         }
        .json-output-container.error-state {
             @apply border-red-400 bg-red-50;
        }
        .json-output-container.error-state pre[class*="language-"] {
             @apply bg-red-50;
        }
         .json-output-container.error-state code[class*="language-"] {
              @apply text-red-800;
         }

         /* Style for copy buttons */
         .copy-button {
            @apply absolute top-2 right-2 px-2 py-1 bg-gray-600 text-white text-xs font-semibold rounded opacity-75 hover:opacity-100 transition-opacity z-10 cursor-pointer;
         }
         .copy-button:focus-visible {
             opacity: 1;
         }
         .copy-button.copied {
             @apply bg-green-500;
         }
         .copy-button.error {
              @apply bg-red-500;
         }

         /* Tab styles (Vanilla JS controlled) */
         .tab-button {
            @apply px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 whitespace-nowrap cursor-pointer;
         }
         .tab-button.active {
             @apply border-indigo-500 text-indigo-600;
         }
         .tab-content {
             @apply hidden p-6 bg-white border border-t-0 border-gray-200 rounded-b-md shadow-inner; /* Removed negative margin, adjusted border */
         }
         .tab-content.active {
             @apply block;
         }

         /* Add some padding to scroll targets */
         section[id], article[id] { /* Target sections/articles used as anchors */
            scroll-margin-top: 80px; /* Increased slightly for more space */
         }

         /* Styling for parameter list */
         .param-list dt {
             @apply font-semibold text-gray-800;
         }
         /* Style inline code within dt */
         .param-list dt code {
             @apply font-mono text-base bg-gray-100 px-1.5 py-0.5 rounded border border-gray-300 text-purple-700;
         }
          .param-list dt span { /* Type hint */
             @apply text-sm font-normal text-gray-500 ml-1;
         }
          .param-list dt .required {
              @apply text-red-600 font-semibold ml-1;
          }
          .param-list dd {
              @apply pl-4 mb-3 text-gray-600;
          }

    </style>
</head>
<body class="bg-gray-50 text-gray-700 antialiased">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50 border-b border-gray-200">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 font-bold text-lg text-gray-800">
                    <a href="#introduction" class="hover:text-indigo-600">Exact Word Definer API</a>
                </div>
                <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                    <a href="#introduction" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:border-indigo-500 hover:text-gray-700">Introduction</a>
                    <a href="#interactive-test" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:border-indigo-500 hover:text-gray-700">Interactive Test</a>
                    <a href="#endpoints" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:border-indigo-500 hover:text-gray-700">Endpoints</a>
                    <a href="#examples" class="inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium text-gray-500 hover:border-indigo-500 hover:text-gray-700">Examples</a>
                </div>
                 <!-- Mobile Menu Button Placeholder (Functionality not added for simplicity) -->
                 <!-- <div class="-mr-2 flex items-center sm:hidden"> ... </div> -->
            </div>
        </div>
    </nav>

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Introduction Section -->
        <section id="introduction" class="mb-12 pt-8">
            <header class="mb-8 text-center">
                <h1 class="text-4xl font-extrabold text-gray-900 mb-3 tracking-tight">Exact Word Definer API</h1>
                <p class="text-lg text-gray-500 mb-1">API Version: <span class="font-semibold text-gray-700">1.12.0</span></p>
                 <p class="mt-4 max-w-3xl mx-auto text-gray-700 text-base sm:text-lg">
                    Welcome! This document provides everything you need to interact with the Exact Word Definer API. Leverage AI to generate precise definitions tailored to your required length, tone, and context. Explore endpoints, see code examples, and test the API live below.
                </p>
            </header>
            <article class="prose prose-indigo lg:prose-lg max-w-none bg-white p-6 rounded-lg shadow border border-gray-200">
                 <h2>Overview</h2>
                 <ul>
                    <li><strong>Define Words/Phrases:</strong> Get definitions constrained by length.</li>
                    <li><strong>Control Tone & Context:</strong> Tailor definitions for specific needs (e.g., <code>formal</code>, <code>informal</code>, <code>legal</code>, <code>educational</code>).</li>
                    <li><strong>Language Support:</strong> Specify output language (ISO 639-3) or use auto-detection.</li>
                    <li><strong>Caching:</strong> Identical requests are cached for faster responses.</li>
                    <li><strong>Metrics:</strong> Monitor API usage and performance via the <code>/api/metrics</code> endpoint.</li>
                </ul>
                 <h2>Getting Started</h2>
                 <ol>
                     <li>Explore the <a href="#endpoints">API Endpoints</a> section to understand the available operations and parameters.</li>
                     <li>Review the <a href="#examples">Code Examples</a> section for integration snippets in various languages.</li>
                     <li>Use the <a href="#interactive-test">Interactive Test</a> forms to experiment with the API directly.</li>
                 </ol>
             </article>
        </section>

        <main class="space-y-16">

             <!-- Interactive Test Section -->
            <section id="interactive-test">
                <h2 class="text-3xl font-bold text-gray-800 border-b border-gray-300 pb-3 mb-6">Interactive API Test</h2>
                <p class="text-gray-600 mb-8 text-lg">
                    Instantly test the API endpoints using the forms below and see the raw JSON response.
                </p>

                <div class="space-y-10">
                    <!-- Test /api/define -->
                    <article class="p-6 bg-white rounded-xl shadow-lg border border-gray-200">
                        <h3 class="text-xl font-semibold text-gray-800 mb-1 flex items-center flex-wrap gap-x-2">
                             <span class="text-xs font-mono px-2 py-0.5 rounded bg-purple-100 text-purple-800 border border-purple-300">POST</span>
                             <span>Test Endpoint:</span>
                             <code class="text-base bg-gray-100 px-2 py-0.5 rounded border border-gray-300 !text-gray-900">/api/define</code>
                        </h3>
                         <p class="text-sm text-gray-500 mb-6">Generate a definition with specific parameters.</p>
                        <form id="defineApiForm" class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                            <!-- Form Fields -->
                            <div class="md:col-span-1">
                                <label for="word" class="block text-sm font-medium text-gray-700 mb-1">Word/Phrase <span class="text-red-600">*</span></label>
                                <input type="text" id="word" name="word" required class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm placeholder-gray-400" placeholder="e.g., Ephemeral">
                            </div>
                             <div class="md:col-span-1">
                                <label for="length" class="block text-sm font-medium text-gray-700 mb-1">Target Length (Words) <span class="text-red-600">*</span></label>
                                <input type="number" id="length" name="length" required min="1" max="250" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm placeholder-gray-400" placeholder="1 - 250 (e.g., 25)">
                            </div>
                            <div class="md:col-span-1">
                                <label for="tone" class="block text-sm font-medium text-gray-700 mb-1">Tone <span class="text-gray-500 text-xs">(Optional)</span></label>
                                <select id="tone" name="tone" class="block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    <option value="">-- Default (Neutral) --</option>
                                    <option value="neutral">Neutral</option>
                                    <option value="formal">Formal</option>
                                    <option value="informal">Informal</option>
                                    <option value="humorous">Humorous</option>
                                    <option value="serious">Serious</option>
                                </select>
                            </div>
                             <div class="md:col-span-1">
                                <label for="context" class="block text-sm font-medium text-gray-700 mb-1">Context <span class="text-gray-500 text-xs">(Optional)</span></label>
                                <select id="context" name="context" class="block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                                    <option value="">-- Default (General) --</option>
                                    <option value="legal">Legal</option>
                                    <option value="educational">Educational</option>
                                    <option value="technical">Technical</option>
                                    <option value="creative">Creative</option>
                                </select>
                            </div>
                             <div class="md:col-span-1">
                                <label for="lang" class="block text-sm font-medium text-gray-700 mb-1">Language <span class="text-gray-500 text-xs">(Optional, ISO 639-3)</span></label>
                                 <input type="text" id="lang" name="lang" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm placeholder-gray-400" placeholder="e.g., eng, spa, fra">
                                 <p class="mt-1 text-xs text-gray-500">Leave blank for auto-detection.</p>
                            </div>
                            <!-- Submit Button & Loading -->
                            <div class="md:col-span-full flex items-center mt-4">
                                <button type="submit" id="submitDefine" class="inline-flex items-center px-6 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Send Request
                                </button>
                                <span id="loadingDefine" class="ml-4 text-indigo-600 hidden items-center">
                                     <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    Processing...
                                </span>
                            </div>
                        </form>

                        <!-- Response Area -->
                        <div class="mt-8">
                            <h4 class="text-lg font-semibold text-gray-700 mb-2">API Response:</h4>
                            <div id="responseDefineWrapper" class="json-output-container">
                                <button class="copy-button" data-clipboard-target="#responseDefineCode" title="Copy to clipboard">Copy</button>
                                <pre class="language-json"><code id="responseDefineCode">{/* Response will appear here */}</code></pre>
                            </div>
                        </div>
                    </article>

                    <!-- Test /api/metrics -->
                    <article class="p-6 bg-white rounded-xl shadow-lg border border-gray-200">
                         <h3 class="text-xl font-semibold text-gray-800 mb-1 flex items-center flex-wrap gap-x-2">
                             <span class="text-xs font-mono px-2 py-0.5 rounded bg-green-100 text-green-800 border border-green-300">GET</span>
                             <span>Test Endpoint:</span>
                             <code class="text-base bg-gray-100 px-2 py-0.5 rounded border border-gray-300 !text-gray-900">/api/metrics</code>
                         </h3>
                          <p class="text-sm text-gray-500 mb-6">Retrieve current operational metrics.</p>
                         <div class="flex items-center">
                             <button id="testMetrics" class="inline-flex items-center px-6 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                Fetch Metrics
                             </button>
                             <span id="loadingMetrics" class="ml-4 text-green-600 hidden items-center">
                                  <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                  </svg>
                                  Loading...
                             </span>
                         </div>
                         <!-- Response Area -->
                         <div class="mt-6">
                            <h4 class="text-lg font-semibold text-gray-700 mb-2">API Response:</h4>
                             <div id="responseMetricsWrapper" class="json-output-container">
                                 <button class="copy-button" data-clipboard-target="#responseMetricsCode" title="Copy to clipboard">Copy</button>
                                 <pre class="language-json"><code id="responseMetricsCode">{/* Response will appear here */}</code></pre>
                            </div>
                        </div>
                    </article>
                </div>
            </section>


            <!-- Endpoints Section -->
            <section id="endpoints">
                <h2 class="text-3xl font-bold text-gray-800 border-b border-gray-300 pb-3 mb-8">API Endpoints</h2>

                <!-- Define Endpoint -->
                <article id="endpoint-define" class="mb-12 p-6 bg-white rounded-xl shadow-lg border border-gray-200">
                    <header class="mb-6">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-1">Define Word/Phrase</h3>
                        <div class="flex items-center flex-wrap space-x-2">
                            <span class="text-sm font-mono px-2.5 py-0.5 rounded bg-purple-100 text-purple-800 border border-purple-300">POST</span>
                            <span class="text-sm font-mono px-2.5 py-0.5 rounded bg-green-100 text-green-800 border border-green-300">GET</span>
                            <code class="text-lg font-mono text-gray-900 bg-gray-100 px-3 py-1 rounded border border-gray-300 !text-gray-900">/api/define</code>
                        </div>
                    </header>
                    <div class="prose prose-indigo max-w-none">
                        <p>Generates a definition for a given word or phrase, aiming for a specific target word count. Uses retry logic and caching for efficiency and accuracy. POST is generally recommended.</p>

                        <h4>Parameters</h4>
                    </div>
                    <dl class="param-list mt-4">
                        <dt><code>word</code> <span>(string)</span> <strong class="required">*Required</strong></dt>
                        <dd>The word or phrase to be defined.</dd>

                        <dt><code>length</code> <span>(integer)</span> <strong class="required">*Required</strong></dt>
                        <dd>The desired word count (1-250).</dd>

                        <dt><code>tone</code> <span>(string, optional)</span></dt>
                        <dd>Desired tone (e.g., <code>neutral</code>, <code>formal</code>, <code>informal</code>, <code>humorous</code>, <code>serious</code>). Defaults to <code>neutral</code>.</dd>

                        <dt><code>context</code> <span>(string, optional)</span></dt>
                        <dd>Specific context (e.g., <code>legal</code>, <code>educational</code>, <code>technical</code>, <code>creative</code>). Helps tailor the definition.</dd>

                        <dt><code>lang</code> <span>(string, optional)</span></dt>
                        <dd>Target language (ISO 639-3 code, e.g., <code>eng</code>, <code>spa</code>, <code>fra</code>). Defaults to auto-detection.</dd>
                    </dl>

                    <div class="prose prose-indigo max-w-none mt-6">
                        <h4>Successful Response (<code>200 OK</code>)</h4>
                        <p>Returns a JSON object with the definition and metadata.</p>
                     </div>
                     <div class="relative">
                         <button class="copy-button" data-clipboard-target="#success-define-response-code" title="Copy to clipboard">Copy</button>
                         <pre class="language-json"><code id="success-define-response-code">{
    "result": "The precisely generated definition text appears here...",
    "word": "example",
    "requestedLength": 50,
    "actualLength": 50,
    "status": "Exact length achieved", // Or "Best effort result (Closest: X words, Difference: Y)"
    "attemptsMade": 1,
    "attemptsHistory": [ /* ... */ ],
    "summaryMetrics": { /* ... */ },
    "finalTemperature": 0.5,
    "requestId": "req_abc123xyz789",
    "config": { /* ... */ },
    "cacheHit": false,
    "cachedAt": null
}</code></pre>
                     </div>

                     <div class="prose prose-indigo max-w-none mt-6">
                        <h4>Error Response (<code>4xx/5xx</code>)</h4>
                        <p>Returned on validation errors, server issues, etc.</p>
                     </div>
                      <div class="relative">
                         <button class="copy-button" data-clipboard-target="#error-define-response-code" title="Copy to clipboard">Copy</button>
                         <pre class="language-json"><code id="error-define-response-code">{
    "error": "ValidationError",
    "message": "Validation failed: 'length' must be less than or equal to 250.",
    "requestId": "req_def456uvw123",
    "details": {
        "field": "length",
        "value": 300
    }
}</code></pre>
                     </div>
                </article>

                <!-- Metrics Endpoint -->
                <article id="endpoint-metrics" class="mb-12 p-6 bg-white rounded-xl shadow-lg border border-gray-200">
                     <header class="mb-6">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-1">View Metrics</h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm font-mono px-2.5 py-0.5 rounded bg-green-100 text-green-800 border border-green-300">GET</span>
                            <code class="text-lg font-mono text-gray-900 bg-gray-100 px-3 py-1 rounded border border-gray-300 !text-gray-900">/api/metrics</code>
                        </div>
                    </header>
                     <div class="prose prose-indigo max-w-none">
                        <p>Provides a snapshot of the API's operational health and usage statistics. No parameters required.</p>

                        <h4>Response (<code>200 OK</code>)</h4>
                        <p>Returns a detailed JSON object with performance indicators.</p>
                    </div>
                    <div class="relative">
                         <button class="copy-button" data-clipboard-target="#metrics-response-code" title="Copy to clipboard">Copy</button>
                         <pre class="language-json"><code id="metrics-response-code">{
    "apiVersion": "1.12.0",
    "serverStartTime": "2023-10-27T10:00:00Z",
    "currentTime": "2023-10-27T12:35:15Z",
    "uptime": "2h 35m 15s",
    "memoryUsage": { /* ... */ },
    "totalRequestsReceived": 1520,
    "processedRequestsSummary": { /* ... */ },
    "apiInteraction": { /* ... */ },
    "wordCounts": { /* ... */ },
    "successRates": { /* ... */ },
    "requestsBreakdown": { /* ... */ },
    "lastMetricUpdate": "2023-10-27T12:35:00Z",
    "config": { /* ... */ }
}</code></pre>
                     </div>
                </article>

            </section>

            <!-- Usage Examples Section -->
            <section id="examples">
                <h2 class="text-3xl font-bold text-gray-800 border-b border-gray-300 pb-3 mb-8">Code Usage Examples</h2>

                <p class="text-gray-600 mb-6 text-lg prose max-w-none">
                    Here’s how to integrate the API. Replace <code>https://define-i05a.onrender.com</code> with your API base URL.
                </p>

                <!-- Tabs for Code Examples -->
                <div>
                     <div class="border-b border-gray-200">
                        <nav id="code-example-tabs" class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Code examples by language">
                            <!-- Tab buttons will be generated by JS -->
                        </nav>
                    </div>

                    <div id="code-example-content" class="mt-0"> <!-- Removed negative margin -->
                        <!-- Tab content panels will be generated by JS -->
                    </div>
                </div>

            </section>

        </main>

        <footer class="mt-16 pt-8 border-t border-gray-300 text-center text-gray-600 text-sm">
            <p class="mb-2">API Documentation © 2025 Exact Word Definer API.</p>
            <p>Developed by <a href="https://www.linkedin.com/in/hasanraiyan/" target="_blank" rel="noopener noreferrer" class="text-indigo-600 hover:text-indigo-800 hover:underline">Raiyan Hasan</a>.</p>
        </footer>

    </div>

    <!-- Prism.js Core & Components (Autoloader recommended for simplicity) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Vanilla JS for Interactivity -->
    <script>
      // Define code examples data structure
      const codeExamples = {
          'Curl': {
              language: 'bash',
              items: [
                  { title: 'POST Request (Define)', id: 'curl-post', code: `curl -X POST \\
  https://define-i05a.onrender.com/api/define \\
  -H "Content-Type: application/json" \\
  -d '{
    "word": "Ephemeral",
    "length": 25,
    "tone": "formal",
    "lang": "eng"
  }'` },
                  { title: 'GET Request (Define)', id: 'curl-get-define', code: `curl -X GET "https://define-i05a.onrender.com/api/define?word=Ephemeral&length=25&tone=formal&lang=eng"` },
                  { title: 'GET Request (Metrics)', id: 'curl-get-metrics', code: `curl -X GET "https://define-i05a.onrender.com/api/metrics"` }
              ]
          },
          'Python': {
               language: 'python',
               items: [
                  { title: 'POST Request (Define)', id: 'python-post', note: 'Requires `requests` library (`pip install requests`).', code: `import requests
import json

api_url = "https://define-i05a.onrender.com/api/define"
headers = {"Content-Type": "application/json", "Accept": "application/json"}
payload = {
    "word": "Serendipity",
    "length": 30,
    "tone": "neutral",
    "context": "educational"
}

try:
    response = requests.post(api_url, headers=headers, json=payload)
    response.raise_for_status() # Raises HTTPError for 4xx/5xx
    result = response.json()
    print("Success:")
    print(json.dumps(result, indent=2))

except requests.exceptions.RequestException as e:
    print(f"Request failed: {e}")
    if e.response is not None:
        print(f"Status Code: {e.response.status_code}")
        try:
            error_details = e.response.json()
            print("Error Response:")
            print(json.dumps(error_details, indent=2))
        except json.JSONDecodeError:
            # Fallback if error response is not JSON
            print(f"Raw Error Response: {e.response.text}")` },
                   { title: 'GET Request (Define)', id: 'python-get-define', code: `import requests
import json

api_url = "https://define-i05a.onrender.com/api/define"
params = {
    "word": "Serendipity",
    "length": 30,
    "tone": "neutral",
    "context": "educational"
}
headers = {"Accept": "application/json"}

try:
    response = requests.get(api_url, headers=headers, params=params)
    response.raise_for_status()
    result = response.json()
    print("Success:")
    print(json.dumps(result, indent=2))
except requests.exceptions.RequestException as e:
    # Handle error similar to POST example...
    print(f"Error: {e}")
    if e.response is not None: print(f"Status: {e.response.status_code}\\n{e.response.text}")`},
                   { title: 'GET Request (Metrics)', id: 'python-get-metrics', code: `import requests
import json

metrics_url = "https://define-i05a.onrender.com/api/metrics"
headers = {"Accept": "application/json"}

try:
    response = requests.get(metrics_url, headers=headers)
    response.raise_for_status()
    metrics = response.json()
    print("Metrics:")
    print(json.dumps(metrics, indent=2))
except requests.exceptions.RequestException as e:
    # Handle error similar to POST example...
    print(f"Error: {e}")
    if e.response is not None: print(f"Status: {e.response.status_code}\\n{e.response.text}")`},
               ]
          },
          'JavaScript': {
               language: 'javascript',
               items: [
                    { title: 'POST Request (Define)', id: 'js-post', note: 'Using Fetch API (Browser/Node.js).', code: `const apiUrl = 'https://define-i05a.onrender.com/api/define';
const data = { word: 'Ubiquitous', length: 20, tone: 'informal' };

async function defineWord() {
    try {
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
            body: JSON.stringify(data),
        });
        const result = await response.json(); // Try to parse JSON regardless of status
        if (!response.ok) {
           // Log error details from JSON payload if available
            console.error('API Error:', result.message || \`HTTP error! Status: \${response.status}\`);
            console.error('Details:', result);
             throw new Error(result.message || \`HTTP error! Status: \${response.status}\`);
        }
        console.log('Success:', result);
    } catch (error) {
        console.error('Operation failed:', error); // Catches fetch errors and thrown errors
    }
}
defineWord();` },
                   { title: 'GET Request (Define)', id: 'js-get-define', code: `const baseUrl = 'https://define-i05a.onrender.com/api/define';
const params = new URLSearchParams({ word: 'Ubiquitous', length: 20, tone: 'informal' });
const url = \`\${baseUrl}?\${params.toString()}\`;

async function getDefinition() {
    try {
        const response = await fetch(url, { headers: { 'Accept': 'application/json' } });
        const result = await response.json();
         if (!response.ok) {
             console.error('API Error:', result.message || \`HTTP error! Status: \${response.status}\`);
             console.error('Details:', result);
             throw new Error(result.message || \`HTTP error! Status: \${response.status}\`);
         }
        console.log('Success:', result);
    } catch (error) {
         console.error('Operation failed:', error);
    }
}
getDefinition();` },
                   { title: 'GET Request (Metrics)', id: 'js-get-metrics', code: `const metricsUrl = 'https://define-i05a.onrender.com/api/metrics';

async function getMetrics() {
    try {
        const response = await fetch(metricsUrl, { headers: { 'Accept': 'application/json' } });
        const result = await response.json();
         if (!response.ok) {
             console.error('API Error:', result.message || \`HTTP error! Status: \${response.status}\`);
             console.error('Details:', result);
             throw new Error(result.message || \`HTTP error! Status: \${response.status}\`);
         }
        console.log('Metrics:', result);
    } catch (error) {
         console.error('Operation failed:', error);
    }
}
getMetrics();` }
               ]
          },
          'Java': {
              language: 'java',
              items: [
                    { title: 'POST Request (Define)', id: 'java-post', note: 'Requires Java 11+, HttpClient, and a JSON library (e.g., Jackson). Full class code omitted for brevity.', code: `import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.Map;
import com.fasterxml.jackson.databind.ObjectMapper; // Requires Jackson library

public class ApiClient {

    private static final HttpClient client = HttpClient.newHttpClient();
    private static final ObjectMapper objectMapper = new ObjectMapper(); // For JSON processing

    public static void main(String[] args) {
        String url = "https://define-i05a.onrender.com/api/define";
        Map<String, Object> data = Map.of(
            "word", "Vorfreude",
            "length", 40,
            "lang", "deu" // Example for a different language
        );

        try {
            String requestBody = objectMapper.writeValueAsString(data);

            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

            // Optional: Parse JSON response
            // if (response.statusCode() >= 200 && response.statusCode() < 300) {
            //     Map<String, Object> result = objectMapper.readValue(response.body(), Map.class);
            //     System.out.println("Parsed Result: " + result.get("result"));
            // } else {
            //     Map<String, Object> errorResult = objectMapper.readValue(response.body(), Map.class);
            //      System.err.println("Error: " + errorResult.get("message"));
            // }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}` },
                    { title: 'GET Request (Define)', id: 'java-get-define', note: 'Requires Java 11+, HttpClient, and optionally Jackson for parsing.', code: `import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class ApiClientMetrics {

    private static final HttpClient client = HttpClient.newHttpClient();

    public static void main(String[] args) {
        String url = "https://define-i05a.onrender.com/api/metrics";

        try {
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .GET()
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}` },
                    { title: 'GET Request (Metrics)', id: 'java-get-metrics', note: 'Requires Java 11+, HttpClient, and optionally Jackson for parsing.', code: `import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.Map;
import com.fasterxml.jackson.databind.ObjectMapper; // Requires Jackson library

public class ApiClient {

    private static final HttpClient client = HttpClient.newHttpClient();
    private static final ObjectMapper objectMapper = new ObjectMapper(); // For JSON processing

    public static void main(String[] args) {
        String url = "https://define-i05a.onrender.com/api/define";
        Map<String, Object> data = Map.of(
            "word", "Vorfreude",
            "length", 40,
            "lang", "deu" // Example for a different language
        );

        try {
            String requestBody = objectMapper.writeValueAsString(data);

            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

            // Optional: Parse JSON response
            // if (response.statusCode() >= 200 && response.statusCode() < 300) {
            //     Map<String, Object> result = objectMapper.readValue(response.body(), Map.class);
            //     System.out.println("Parsed Result: " + result.get("result"));
            // } else {
            //     Map<String, Object> errorResult = objectMapper.readValue(response.body(), Map.class);
            //      System.err.println("Error: " + errorResult.get("message"));
            // }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}` }
              ]
          }
      };


        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element References ---
            const defineForm = document.getElementById('defineApiForm');
            const responseDefineWrapper = document.getElementById('responseDefineWrapper');
            const responseDefineCode = document.getElementById('responseDefineCode');
            const loadingDefine = document.getElementById('loadingDefine');
            const submitDefineButton = document.getElementById('submitDefine');

            const testMetricsButton = document.getElementById('testMetrics');
            const responseMetricsWrapper = document.getElementById('responseMetricsWrapper');
            const responseMetricsCode = document.getElementById('responseMetricsCode');
            const loadingMetrics = document.getElementById('loadingMetrics');

            const codeExampleTabsContainer = document.getElementById('code-example-tabs');
            const codeExampleContentContainer = document.getElementById('code-example-content');

            const apiUrl = 'https://define-i05a.onrender.com/api/'; // Base API URL

            // --- Helper: Display JSON/Text in Response Areas ---
            function displayResponse(codeElement, wrapperElement, data, isError = false, isJson = true) {
                wrapperElement.classList.remove('error-state');
                let content = '';
                let langClass = 'language-json';

                if (isJson) {
                    try {
                        content = JSON.stringify(data, null, 2); // Pretty print JSON
                    } catch (e) {
                        content = `// Error formatting JSON response:\n${String(data)}`; // Ensure data is stringified
                        isError = true; // Mark as error if formatting failed
                    }
                } else {
                    content = String(data); // Ensure data is a string
                    langClass = 'language-text'; // Treat non-JSON as plain text
                }
                codeElement.textContent = content;
                codeElement.className = langClass; // Set the language class for Prism

                if (isError) {
                    wrapperElement.classList.add('error-state');
                }

                Prism.highlightElement(codeElement); // Re-highlight the element
            }

            // --- Helper: Make API Request ---
            async function makeApiRequest(url, options, codeElement, wrapperElement, loadingElement, submitButton) {
                 // Reset UI state before request
                 codeElement.textContent = '{/* Waiting for response... */}';
                 codeElement.className = 'language-json'; // Default to JSON for placeholder
                 wrapperElement.classList.remove('error-state');
                 Prism.highlightElement(codeElement);
                 loadingElement.classList.remove('hidden');
                 if (submitButton) submitButton.disabled = true;

                 try {
                     const response = await fetch(url, options);
                     const contentType = response.headers.get("content-type");
                     let responseBody;

                     // Check if response indicates JSON content
                     if (contentType && contentType.includes("application/json")) {
                         responseBody = await response.json();
                         displayResponse(codeElement, wrapperElement, responseBody, !response.ok, true);
                     } else {
                         // Handle as text otherwise
                         responseBody = await response.text();
                         // Display text, marking as error if status code is not OK (2xx)
                         displayResponse(codeElement, wrapperElement, responseBody, !response.ok, false);
                     }
                 } catch (error) {
                     // Handle network errors or other fetch-related issues
                     console.error('Fetch error:', error);
                     displayResponse(codeElement, wrapperElement, {
                           error: "NetworkError",
                           message: `Failed to fetch resource. ${error.message}. Please check network connection and API endpoint.`
                       }, true, true); // Display as a JSON error object
                 } finally {
                     // Reset loading/disabled state regardless of outcome
                     loadingElement.classList.add('hidden');
                     if (submitButton) submitButton.disabled = false;
                 }
             }

            // --- Interactive Test: Define Form Submission ---
            defineForm.addEventListener('submit', (event) => {
                event.preventDefault(); // Prevent default form submission
                const wordInput = document.getElementById('word');
                const lengthInput = document.getElementById('length');

                // Client-side validation
                if (!wordInput.value.trim()) {
                    displayResponse(responseDefineCode, responseDefineWrapper, { error: "ClientError", message: "Word/Phrase cannot be empty." }, true, true);
                    wordInput.focus(); return;
                }
                const length = parseInt(lengthInput.value, 10);
                if (isNaN(length) || length < 1 || length > 250) {
                      displayResponse(responseDefineCode, responseDefineWrapper, { error: "ClientError", message: "Target Length must be an integer between 1 and 250." }, true, true);
                      lengthInput.focus(); return;
                 }

                // Construct payload, omitting undefined optional fields
                const payload = {
                    word: wordInput.value.trim(), length: length,
                    tone: document.getElementById('tone').value || undefined,
                    context: document.getElementById('context').value || undefined,
                    lang: document.getElementById('lang').value.trim() || undefined
                };
                // Remove keys with undefined values for a cleaner payload
                 const cleanPayload = Object.entries(payload)
                    .filter(([_, v]) => v !== undefined)
                    .reduce((acc, [k, v]) => ({ ...acc, [k]: v }), {});


                 // Prepare and make the API request
                 makeApiRequest(`${apiUrl}define`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                        body: JSON.stringify(cleanPayload)
                    }, responseDefineCode, responseDefineWrapper, loadingDefine, submitDefineButton);
            });

            // --- Interactive Test: Metrics Button Click ---
            testMetricsButton.addEventListener('click', () => {
                 makeApiRequest(`${apiUrl}metrics`, {
                     method: 'GET', headers: { 'Accept': 'application/json' }
                     }, responseMetricsCode, responseMetricsWrapper, loadingMetrics, testMetricsButton);
            });

            // --- Code Example Tabs Generation and Logic ---
            const tabKeys = Object.keys(codeExamples);

            tabKeys.forEach((key, index) => {
                const languageData = codeExamples[key];
                const panelId = `tab-content-${key.toLowerCase().replace(/[^a-z0-9]/g, '-')}`; // Sanitize ID

                // Create Tab Button
                const button = document.createElement('button');
                button.className = 'tab-button';
                button.textContent = key;
                button.setAttribute('role', 'tab');
                button.setAttribute('aria-controls', panelId);
                button.setAttribute('aria-selected', index === 0 ? 'true' : 'false');
                button.dataset.target = panelId;
                if (index === 0) button.classList.add('active');
                codeExampleTabsContainer.appendChild(button);

                // Create Tab Content Panel
                const panel = document.createElement('div');
                panel.id = panelId;
                panel.className = 'tab-content';
                panel.setAttribute('role', 'tabpanel');
                panel.setAttribute('aria-labelledby', button.id || `tab-button-${key.toLowerCase().replace(/[^a-z0-9]/g, '-')}`); // Link panel to button
                if (index === 0) panel.classList.add('active');

                // Populate panel with code examples for this language
                languageData.items.forEach(item => {
                     const itemWrapper = document.createElement('div');
                     itemWrapper.className = 'mb-6';

                     const title = document.createElement('h4');
                     title.className = 'text-lg font-semibold text-gray-700 mb-1';
                     title.textContent = item.title;
                     itemWrapper.appendChild(title);

                     if (item.note) {
                         const note = document.createElement('p');
                         note.className = 'text-sm text-gray-500 mb-2 italic';
                         note.textContent = item.note;
                         itemWrapper.appendChild(note);
                     }

                     const pre = document.createElement('pre');
                     // Important: Add data-prismjs-copy-timeout to prevent Prism's default copy handler if using plugins
                     pre.setAttribute('data-prismjs-copy-timeout', '500');
                     pre.className = `language-${languageData.language}`;
                     pre.dataset.id = item.id; // Unique ID for the code block

                     const code = document.createElement('code');
                     code.textContent = item.code;
                     pre.appendChild(code);

                     // Add our custom copy button
                     const copyButton = document.createElement('button');
                     copyButton.className = 'copy-button';
                     copyButton.title = 'Copy code to clipboard';
                     copyButton.textContent = 'Copy';
                      // Use a more robust selector targeting the code within this specific pre element
                     copyButton.dataset.clipboardTarget = `#${panelId} pre[data-id='${item.id}'] > code`;
                     pre.appendChild(copyButton);

                     itemWrapper.appendChild(pre);
                     panel.appendChild(itemWrapper);
                });
                codeExampleContentContainer.appendChild(panel);
            });

            // Tab Button Click Handler (Event Delegation)
            codeExampleTabsContainer.addEventListener('click', (event) => {
                const clickedButton = event.target.closest('.tab-button');
                if (clickedButton && !clickedButton.classList.contains('active')) { // Only act if a non-active button is clicked
                    const targetPanelId = clickedButton.dataset.target;

                    // Deactivate all buttons and panels first
                    codeExampleTabsContainer.querySelectorAll('.tab-button').forEach(btn => {
                        btn.classList.remove('active');
                        btn.setAttribute('aria-selected', 'false');
                    });
                    codeExampleContentContainer.querySelectorAll('.tab-content').forEach(panel => {
                        panel.classList.remove('active');
                    });

                    // Activate the clicked button and its corresponding panel
                    clickedButton.classList.add('active');
                    clickedButton.setAttribute('aria-selected', 'true');
                    const targetPanel = document.getElementById(targetPanelId);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                        // Ensure Prism highlights content in the newly activated panel
                        targetPanel.querySelectorAll('pre code').forEach(block => {
                           Prism.highlightElement(block);
                        });
                    }
                }
            });

             // --- Clipboard Functionality (Event Delegation on Body) ---
             document.body.addEventListener('click', function(event) {
                const button = event.target.closest('.copy-button');
                if (button && !button.disabled) { // Check if the clicked element is a copy button and not disabled
                    const targetSelector = button.dataset.clipboardTarget;
                    let codeElement;
                    try {
                        // Attempt to find the target element using the selector
                         codeElement = document.querySelector(targetSelector);
                    } catch (e) {
                        console.error("Invalid selector for copy button:", targetSelector, e);
                        codeElement = null; // Ensure codeElement is null if selector fails
                    }


                    if (codeElement) {
                        navigator.clipboard.writeText(codeElement.textContent)
                            .then(() => {
                                // Success feedback
                                const originalText = button.textContent;
                                button.textContent = 'Copied!';
                                button.classList.add('copied');
                                button.disabled = true; // Temporarily disable after copy
                                setTimeout(() => {
                                    button.textContent = originalText;
                                    button.classList.remove('copied');
                                    button.disabled = false; // Re-enable
                                }, 1500); // Shorter timeout for feedback
                            })
                            .catch(err => {
                                // Error feedback
                                console.error('Failed to copy text: ', err);
                                const originalText = button.textContent;
                                button.textContent = 'Error';
                                button.classList.add('error');
                                button.disabled = true;
                                setTimeout(() => {
                                    button.textContent = originalText;
                                    button.classList.remove('error');
                                    button.disabled = false;
                                }, 2000);
                            });
                    } else {
                        console.warn("Copy button target element not found with selector:", targetSelector);
                         // Provide feedback even if target isn't found (optional)
                         button.textContent = 'Target?';
                         button.classList.add('error');
                         setTimeout(() => { button.textContent = 'Copy'; button.classList.remove('error'); }, 2000);
                    }
                }
            });

            // --- Initial Highlighting ---
            // Prism.highlightAll() might be called automatically by autoloader,
            // but calling it explicitly ensures highlighting after initial DOM setup.
             try {
                Prism.highlightAll();
             } catch (e) {
                 console.error("Prism highlighting failed on initial load:", e);
             }

        }); // End DOMContentLoaded
    </script>

</body>
</html>