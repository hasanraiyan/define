<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exact Word Definer API Documentation</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Optional: Basic custom style for better code formatting, complements Tailwind */
        pre code {
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.4;
            white-space: pre-wrap; /* Handle long lines */
            word-break: break-all; /* Prevent overflow on long lines */
        }
        .json-output {
             font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.4;
            background-color: #1a202c; /* gray-800 */
            color: #ffffff; /* white */
            padding: 1rem; /* p-4 */
            border-radius: 0.25rem; /* rounded-md */
            overflow-x: auto;
            min-height: 50px; /* Give it some minimum height */
        }
         .json-output.error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
            border: 1px solid #f87171; /* red-400 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center text-gray-900 mb-2">Exact Word Definer API Documentation</h1>
            <p class="text-center text-gray-600">API Version: 1.12.0</p>
            <p class="text-center mt-4 max-w-2xl mx-auto">This document provides details and examples for interacting with the Exact Word Definer API, which uses AI to generate definitions of a specified length. You can also test the API directly from this page.</p>
        </header>

        <main class="space-y-10">

             <!-- Interactive Test Section -->
            <section id="interactive-test">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-6">Interactive API Test</h2>
                <p class="text-gray-700 mb-6">Use the form below to test the <code class="font-mono">/api/define</code> endpoint and see the response live.

                <div class="p-6 bg-white rounded-lg shadow-md mb-8">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Test /api/define (POST)</h3>
                    <form id="defineApiForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="col-span-1">
                            <label for="word" class="block text-sm font-medium text-gray-700 mb-1">Word/Phrase <span class="text-red-600">*</span></label>
                            <input type="text" id="word" name="word" required class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="e.g., Ephemeral">
                        </div>
                         <div class="col-span-1">
                            <label for="length" class="block text-sm font-medium text-gray-700 mb-1">Target Length (Words) <span class="text-red-600">*</span></label>
                            <input type="number" id="length" name="length" required min="1" max="250" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="e.g., 25">
                        </div>
                        <div class="col-span-1">
                            <label for="tone" class="block text-sm font-medium text-gray-700 mb-1">Tone (Optional)</label>
                            <select id="tone" name="tone" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="">-- Select Tone --</option>
                                <option value="neutral">Neutral</option>
                                <option value="formal">Formal</option>
                                <option value="informal">Informal</option>
                                <option value="humorous">Humorous</option>
                                <option value="serious">Serious</option>
                            </select>
                        </div>
                         <div class="col-span-1">
                            <label for="context" class="block text-sm font-medium text-gray-700 mb-1">Context (Optional)</label>
                            <select id="context" name="context" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="">-- Select Context --</option>
                                <option value="legal">Legal</option>
                                <option value="educational">Educational</option>
                                <!-- Add other valid contexts here -->
                            </select>
                        </div>
                         <div class="col-span-1">
                            <label for="lang" class="block text-sm font-medium text-gray-700 mb-1">Language (Optional, ISO 639-3)</label>
                             <input type="text" id="lang" name="lang" class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="e.g., eng, spa, fra">
                             <p class="mt-1 text-xs text-gray-500">Leave blank for auto-detection.</p>
                        </div>
                        <div class="col-span-full flex justify-start">
                            <button type="submit" id="submitDefine" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Test /api/define (POST)
                            </button>
                            <span id="loadingDefine" class="ml-4 mt-2 text-blue-600 hidden">Loading...</span>
                        </div>
                    </form>

                    <div class="mt-8">
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">API Response:</h4>
                        <pre id="responseDefine" class="json-output"><code></code></pre>
                    </div>
                </div>

                <div class="p-6 bg-white rounded-lg shadow-md">
                     <h3 class="text-xl font-semibold text-gray-700 mb-4">Test /api/metrics (GET)</h3>
                     <button id="testMetrics" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                        Test /api/metrics (GET)
                     </button>
                      <span id="loadingMetrics" class="ml-4 mt-2 text-green-600 hidden">Loading...</span>
                     <div class="mt-4">
                        <h4 class="text-lg font-semibold text-gray-700 mb-2">API Response:</h4>
                        <pre id="responseMetrics" class="json-output"><code></code></pre>
                    </div>
                </div>

            </section>


            <!-- Endpoints Section -->
            <section id="endpoints" class="mt-10">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-6">API Endpoints</h2>

                <!-- Define Endpoint -->
                <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Define Word</h3>
                    <p class="text-sm font-mono text-blue-600 mb-2">POST | GET</p>
                    <p class="text-lg font-mono text-gray-900 mb-4"><code>/api/define</code></p>
                    <p class="text-gray-700 mb-4">Generates a definition for a given word with a target word count. Supports retries and temperature adjustment to improve accuracy. Returns a cached result if available for the exact parameters (word, length, tone, context, language).</p>

                    <h4 class="text-lg font-semibold text-gray-700 mb-2">Parameters:</h4>
                    <ul class="list-disc list-inside pl-4 space-y-2 text-gray-600">
                        <li>
                            <code class="font-mono">word</code> (<code class="font-mono text-red-600">string</code>):
                            <span class="font-semibold">Required.</span> The word or phrase to define.
                        </li>
                        <li>
                            <code class="font-mono">length</code> (<code class="font-mono text-red-600">integer</code>):
                            <span class="font-semibold">Required.</span> The target word count for the definition (1 to 250).
                        </li>
                         <li>
                             <code class="font-mono">tone</code> (<code class="font-mono">string</code>):
                             <span class="font-semibold">Optional.</span> The desired tone for the definition. Defaults to "neutral".
                             Valid values: <code class="font-mono">neutral</code>, <code class="font-mono">formal</code>, <code class="font-mono">informal</code>, <code class="font-mono">humorous</code>, <code class="font-mono">serious</code>.
                         </li>
                         <li>
                             <code class="font-mono">context</code> (<code class="font-mono">string</code>):
                             <span class="font-semibold">Optional.</span> The specific context for the definition.
                             Valid values: <code class="font-mono">legal</code>, <code class="font-mono">educational</code>.
                         </li>
                         <li>
                            <code class="font-mono">lang</code> (<code class="font-mono">string</code>):
                            <span class="font-semibold">Optional.</span> The desired language (ISO 639-3 code, e.g., 'eng', 'spa', 'fra'). If omitted, the API attempts to detect the language of the 'word' parameter.
                        </li>
                    </ul>

                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-4">Successful Response (JSON Object):</h4>
                     <p class="text-gray-700">A JSON object containing the definition and details about the request processing. HTTP Status: 200 OK.</p>
                     <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">{
    "result": "The generated definition text...",
    "word": "example",
    "requestedLength": 50,
    "actualLength": 50, // Or the closest length if exact match not found
    "status": "Exact length achieved" | "Best effort result (Closest: X words, Difference: Y)",
    "attemptsMade": 1, // Or the number of API attempts
    "attemptsHistory": [...], // Details of each API attempt
    "summaryMetrics": { ... }, // Token usage, timing, temperature range
    "finalTemperature": 0.5,
    "requestId": "...",
    "config": { ... }, // Config details for this specific request
    "cacheHit": true | false,
    "cachedAt": "..." // Timestamp if cacheHit is true
}</code></pre>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-4">Error Response (JSON Object):</h4>
                    <p class="text-gray-700">Returned on error conditions. HTTP Status: 400, 429, 503, 500, etc.</p>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">{
    "error": "ErrorType", // e.g., "ValidationError", "ApiError", "InternalError"
    "message": "A descriptive error message.",
    "requestId": "...", // Optional, request ID if processing started
    "details": { ... } // Optional, additional error details
}</code></pre>
                </div>

                <!-- Metrics Endpoint -->
                <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">View Metrics</h3>
                    <p class="text-sm font-mono text-green-600 mb-2">GET</p>
                    <p class="text-lg font-mono text-gray-900 mb-4"><code>/api/metrics</code></p>
                    <p class="text-gray-700 mb-4">Provides a snapshot of the API's operational metrics, including request counts, success rates, cache performance, API interaction details, and configuration.</p>

                    <h4 class="text-lg font-semibold text-gray-700 mb-2">Parameters:</h4>
                    <p class="text-gray-700">None.</p>

                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-4">Response (JSON Object):</h4>
                    <p class="text-gray-700">A detailed JSON object containing various metrics and configuration parameters. HTTP Status: 200 OK.</p>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">{
    "apiVersion": "...",
    "serverStartTime": "...",
    "currentTime": "...",
    "uptime": "...",
    "memoryUsage": { ... },
    "totalRequestsReceived": 0,
    "processedRequestsSummary": { ... }, // Breakdown of processed requests by status
    "apiInteraction": { ... }, // API call errors, cache metrics, metrics saving status
    "wordCounts": { ... }, // Aggregate word counts
    "successRates": { ... },
    "requestsBreakdown": { ... }, // Counts by tone, context, language
    "lastMetricUpdate": "...",
    "config": { ... } // Current configuration settings
}</code></pre>
                </div>

            </section>

            <!-- Usage Examples Section -->
            <section id="examples">
                <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2 mb-6">Code Usage Examples</h2>

                <p class="text-gray-700 mb-4">Below are code examples for interacting with the API using different programming languages. Remember to replace <code class="font-mono">https://define-i05a.onrender.com</code> with your API's base URL.</p>

                <!-- Curl Example -->
                <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Curl</h3>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2">POST Request (Recommended for defining):</h4>
                     <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">curl -X POST \
  https://define-i05a.onrender.com/api/define \
  -H "Content-Type: application/json" \
  -d '{
    "word": "Ephemeral",
    "length": 25,
    "tone": "formal",
    "lang": "eng"
  }'</code></pre>
                   <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">curl -X GET "https://define-i05a.onrender.com/api/define?word=Ephemeral&length=25&tone=formal&lang=eng"</code></pre>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Metrics:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">curl -X GET "https://define-i05a.onrender.com/api/metrics"</code></pre>
                </div>

                <!-- Python Example -->
                <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Python (using <code>requests</code>)</h3>
                    <p class="text-gray-700 mb-2">Install requests: <code class="font-mono">pip install requests</code></p>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2">POST Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import requests
import json

url = "https://define-i05a.onrender.com/api/define"
headers = {"Content-Type": "application/json"}
data = {
    "word": "Serendipity",
    "length": 30,
    "tone": "neutral",
    "context": "educational"
}

try:
    response = requests.post(url, headers=headers, data=json.dumps(data))
    response.raise_for_status() # Raise an HTTPError for bad responses (4xx or 5xx)
    result = response.json()
    print("Success:")
    print(json.dumps(result, indent=2))
except requests.exceptions.RequestException as e:
    print(f"Error: {e}")
    if hasattr(e, 'response') and e.response is not None:
         try:
              error_details = e.response.json()
              print(f"Error Details:")
              print(json.dumps(error_details, indent=2))
         except json.JSONDecodeError:
              print(f"Error Response Body: {e.response.text}")

</code></pre>
                   <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import requests
import json

url = "https://define-i05a.onrender.com/api/define"
params = {
    "word": "Serendipity",
    "length": 30,
    "tone": "neutral",
    "context": "educational"
}

try:
    response = requests.get(url, params=params)
    response.raise_for_status() # Raise an HTTPError for bad responses (4xx or 5xx)
    result = response.json()
    print("Success:")
    print(json.dumps(result, indent=2))
except requests.exceptions.RequestException as e:
    print(f"Error: {e}")
    if hasattr(e, 'response') and e.response is not None:
         try:
              error_details = e.response.json()
              print(f"Error Details:")
              print(json.dumps(error_details, indent=2))
         except json.JSONDecodeError:
              print(f"Error Response Body: {e.response.text}")
</code></pre>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Metrics:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import requests
import json

url = "https://define-i05a.onrender.com/api/metrics"

try:
    response = requests.get(url)
    response.raise_for_status() # Raise an HTTPError for bad responses (4xx or 5xx)
    result = response.json()
    print("Metrics:")
    print(json.dumps(result, indent=2))
except requests.exceptions.RequestException as e:
    print(f"Error fetching metrics: {e}")
    if hasattr(e, 'response') and e.response is not None:
         try:
              error_details = e.response.json()
              print(f"Error Details:")
              print(json.dumps(error_details, indent=2))
         except json.JSONDecodeError:
              print(f"Error Response Body: {e.response.text}")
</code></pre>
                </div>

                 <!-- JavaScript Example -->
                 <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                     <h3 class="text-xl font-semibold text-gray-700 mb-4">JavaScript (using Fetch API)</h3>
                     <h4 class="text-lg font-semibold text-gray-700 mb-2">POST Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">const url = 'https://define-i05a.onrender.com/api/define';
const data = {
    word: 'Ubiquitous',
    length: 20,
    tone: 'informal'
};

fetch(url, {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
})
.then(response => {
    if (!response.ok) {
        // Check for non-2xx status codes
        return response.json().then(err => { throw new Error(err.message || \`HTTP error! status: \${response.status}\`); });
    }
    return response.json();
})
.then(result => {
    console.log('Success:', result);
})
.catch(error => {
    console.error('Error:', error);
});</code></pre>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Request:</h4>
                     <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">const params = new URLSearchParams({
    word: 'Ubiquitous',
    length: 20,
    tone: 'informal'
});
const url = \`https://define-i05a.onrender.com/api/define?\${params.toString()}\`;

fetch(url)
.then(response => {
    if (!response.ok) {
         // Check for non-2xx status codes
        return response.json().then(err => { throw new Error(err.message || \`HTTP error! status: \${response.status}\`); });
    }
    return response.json();
})
.then(result => {
    console.log('Success:', result);
})
.catch(error => {
    console.error('Error:', error);
});</code></pre>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Metrics:</h4>
                     <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">const url = 'https://define-i05a.onrender.com/api/metrics';

fetch(url)
.then(response => {
    if (!response.ok) {
         // Check for non-2xx status codes
        return response.json().then(err => { throw new Error(err.message || \`HTTP error! status: \${response.status}\`); });
    }
    return response.json();
})
.then(result => {
    console.log('Metrics:', result);
})
.catch(error => {
    console.error('Error fetching metrics:', error);
});</code></pre>
                </div>

                <!-- Java Example -->
                <div class="mb-8 p-6 bg-white rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Java (using <code>java.net.http.HttpClient</code> - Java 11+)</h3>
                    <p class="text-gray-700 mb-2">Make sure you are using Java 11 or newer.</p>
                    <h4 class="text-lg font-semibold text-gray-700 mb-2">POST Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.Map;
import com.fasterxml.jackson.databind.ObjectMapper; // Requires Jackson library

public class ApiClient {

    private static final HttpClient client = HttpClient.newHttpClient();
    private static final ObjectMapper objectMapper = new ObjectMapper(); // For JSON processing

    public static void main(String[] args) {
        String url = "https://define-i05a.onrender.com/api/define";
        Map<String, Object> data = Map.of(
            "word", "Vorfreude",
            "length", 40,
            "lang", "deu" // Example for a different language
        );

        try {
            String requestBody = objectMapper.writeValueAsString(data);

            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

            // Optional: Parse JSON response
            // if (response.statusCode() >= 200 && response.statusCode() < 300) {
            //     Map<String, Object> result = objectMapper.readValue(response.body(), Map.class);
            //     System.out.println("Parsed Result: " + result.get("result"));
            // } else {
            //     Map<String, Object> errorResult = objectMapper.readValue(response.body(), Map.class);
            //      System.err.println("Error: " + errorResult.get("message"));
            // }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                    <p class="text-gray-700 mt-2">Note: The Java example requires a JSON processing library like Jackson (<code class="font-mono">com.fasterxml.jackson.core:jackson-databind</code>).</p>

                    <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Request:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.net.URLEncoder;
import java.nio.charset.StandardCharsets;
import java.util.Map;
import java.util.stream.Collectors;

public class ApiClientGet {

    private static final HttpClient client = HttpClient.newHttpClient();

    public static void main(String[] args) {
        String baseUrl = "https://define-i05a.onrender.com/api/define";
        Map<String, String> params = Map.of(
             "word", "Vorfreude",
             "length", "40", // Parameters must be strings for URL encoding
             "lang", "deu"
        );

        String query = params.entrySet().stream()
            .map(entry -> {
                String key = URLEncoder.encode(entry.getKey(), StandardCharsets.UTF_8);
                String value = URLEncoder.encode(entry.getValue(), StandardCharsets.UTF_8);
                return key + "=" + value;
            })
            .collect(Collectors.joining("&"));

        String url = baseUrl + "?" + query;

        try {
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .GET() // Explicitly GET
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                     <h4 class="text-lg font-semibold text-gray-700 mb-2 mt-6">GET Metrics:</h4>
                    <pre><code class="block bg-gray-800 text-white p-4 rounded-md overflow-x-auto text-sm">import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class ApiClientMetrics {

    private static final HttpClient client = HttpClient.newHttpClient();

    public static void main(String[] args) {
        String url = "https://define-i05a.onrender.com/api/metrics";

        try {
            HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .GET()
                .build();

            HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

            System.out.println("Status Code: " + response.statusCode());
            System.out.println("Response Body:");
            System.out.println(response.body());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                </div>


            </section>

        </main>

        <footer class="mt-10 pt-6 border-t border-gray-300 text-center text-gray-600 text-sm">
            <p>Â© 2025 Raiyan Hasan. All rights reserved.</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const defineForm = document.getElementById('defineApiForm');
            const responseDefine = document.getElementById('responseDefine').querySelector('code');
            const loadingDefine = document.getElementById('loadingDefine');
            const submitDefineButton = document.getElementById('submitDefine');

            const testMetricsButton = document.getElementById('testMetrics');
            const responseMetrics = document.getElementById('responseMetrics').querySelector('code');
            const loadingMetrics = document.getElementById('loadingMetrics');

            const apiUrl = 'https://define-i05a.onrender.com/api/'; // Base URL for API calls

            // Function to display JSON output
            function displayJson(outputElement, data, isError = false) {
                outputElement.parentElement.classList.remove('error');
                 if(isError) {
                    outputElement.parentElement.classList.add('error');
                 }
                try {
                    outputElement.textContent = JSON.stringify(data, null, 2);
                } catch (e) {
                    outputElement.textContent = 'Error formatting JSON: ' + data;
                     outputElement.parentElement.classList.add('error');
                }
            }

             // Function to display raw text output (for non-JSON errors)
             function displayTextError(outputElement, text, status) {
                 outputElement.parentElement.classList.remove('error');
                 outputElement.parentElement.classList.add('error');
                 outputElement.textContent = `HTTP Status ${status}: ${text}`;
             }

            // Handle Define API Form Submission
            defineForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                // Clear previous output and hide error class
                responseDefine.textContent = '';
                 responseDefine.parentElement.classList.remove('error');

                const wordInput = document.getElementById('word');
                const lengthInput = document.getElementById('length');

                // Basic client-side validation
                if (!wordInput.value.trim()) {
                    displayJson(responseDefine, { error: "Client-side Error", message: "Word/Phrase is required." }, true);
                    return;
                }
                 const length = parseInt(lengthInput.value, 10);
                 if (isNaN(length) || length < 1 || length > 250) {
                     displayJson(responseDefine, { error: "Client-side Error", message: "Length must be an integer between 1 and 250." }, true);
                     return;
                 }


                const data = {
                    word: wordInput.value.trim(),
                    length: length,
                    tone: document.getElementById('tone').value || undefined, // Use undefined if empty
                    context: document.getElementById('context').value || undefined, // Use undefined if empty
                    lang: document.getElementById('lang').value.trim() || undefined // Use undefined if empty
                };

                 // Remove undefined keys for cleaner payload
                 Object.keys(data).forEach(key => data[key] === undefined && delete data[key]);

                loadingDefine.classList.remove('hidden');
                submitDefineButton.disabled = true;
                submitDefineButton.classList.add('opacity-50', 'cursor-not-allowed');

                try {
                    const response = await fetch(`${apiUrl}define`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data),
                    });

                    let result;
                    try {
                         // Try to parse JSON first
                         result = await response.json();
                    } catch (jsonError) {
                         // If JSON parsing fails, get raw text
                         const textResult = await response.text();
                          if (!response.ok) {
                             displayTextError(responseDefine, textResult || 'Unknown Error', response.status);
                          } else {
                             // Unexpected non-JSON success? Display text.
                             responseDefine.textContent = textResult;
                          }
                         return; // Stop processing if JSON parsing failed
                    }


                    if (!response.ok) {
                        // Handle HTTP errors (4xx, 5xx) - API returns JSON errors
                        displayJson(responseDefine, result, true);
                    } else {
                        // Handle successful response (2xx)
                        displayJson(responseDefine, result);
                    }

                } catch (error) {
                    console.error('Fetch error:', error);
                    displayJson(responseDefine, { error: "Network Error", message: error.message }, true);
                } finally {
                    loadingDefine.classList.add('hidden');
                    submitDefineButton.disabled = false;
                    submitDefineButton.classList.remove('opacity-50', 'cursor-not-allowed');
                }
            });

            // Handle Metrics API Button Click
            testMetricsButton.addEventListener('click', async () => {
                 // Clear previous output and hide error class
                responseMetrics.textContent = '';
                 responseMetrics.parentElement.classList.remove('error');

                 loadingMetrics.classList.remove('hidden');
                 testMetricsButton.disabled = true;
                 testMetricsButton.classList.add('opacity-50', 'cursor-not-allowed');

                try {
                    const response = await fetch(`${apiUrl}metrics`);

                    let result;
                    try {
                         result = await response.json();
                    } catch (jsonError) {
                         const textResult = await response.text();
                          if (!response.ok) {
                             displayTextError(responseMetrics, textResult || 'Unknown Error', response.status);
                          } else {
                             responseMetrics.textContent = textResult; // Unexpected non-JSON success?
                          }
                         return;
                    }


                    if (!response.ok) {
                         // Handle HTTP errors (4xx, 5xx)
                        displayJson(responseMetrics, result, true);
                    } else {
                        // Handle successful response (2xx)
                        displayJson(responseMetrics, result);
                    }

                } catch (error) {
                    console.error('Fetch error:', error);
                     displayJson(responseMetrics, { error: "Network Error", message: error.message }, true);
                } finally {
                     loadingMetrics.classList.add('hidden');
                     testMetricsButton.disabled = false;
                     testMetricsButton.classList.remove('opacity-50', 'cursor-not-allowed');
                }
            });
        });
    </script>

</body>
</html>